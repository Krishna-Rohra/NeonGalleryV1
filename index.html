<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Neon Image Gallery</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>
<body>

<!-- Auth Section -->
<div id="auth-section" class="auth-container">
  <h2 class="neon-text">Welcome to Neon Gallery</h2>
  <input type="text" id="name" placeholder="Name (Sign Up Only)" />
  <input type="email" id="email" placeholder="Email" />
  <input type="password" id="password" placeholder="Password" />
  <div class="auth-buttons">
    <button id="signup" class="neon-button">Sign Up</button>
    <button id="login" class="neon-button">Login</button>
  </div>
</div>

<!-- Header -->
<header>
  <h1 class="neon-text">Neon Gallery</h1>
  
  <!-- Nav Menu Wrapper -->
  <div class="menu-wrapper">
    <button id="menu-toggle" class="neon-button"><i class="fas fa-bars"></i></button>
    <div id="menu-dropdown" class="dropdown hidden">
      <button id="toggle-theme" class="neon-button">ðŸŒ— Theme</button>
      <button id="toggle-favorites" class="neon-button">
        <i class="fas fa-heart"></i> Favorites
      </button>
      <button id="logout-btn" class="neon-button">Logout</button>
    </div>
  </div>
</header>

<section class="upload-section">
  <label class="upload-btn neon-button">
    Upload Image
    <input type="file" id="image-input" accept="image/*" hidden />
  </label>
  <div class="progress-bar" id="progress-bar"></div>
</section>

<section class="gallery" id="gallery"></section>

<div id="viewer" class="viewer">
  <span id="close-viewer">&times;</span>
  <img id="viewer-image" src="" alt="Full View" />
  <div id="viewer-info" class="upload-info"></div>
</div>

<div class="circle"></div>

<button id="audio-toggle" class="neon-audio-button" title="Toggle Music">ðŸ”Š</button>

<audio id="bg-music" loop autoplay>
  <source src="music/Cinematic.mp4" type="audio/mp4" />
</audio>

<!-- Footer -->
<footer class="footer" id="footer" style="display: none;">
  <p>Â© 2025 Neon Gallery â€” Crafted with âš¡ by <strong>Krishna and Shubham</strong></p>
  <div class="footer-links">
    <a href="https://github.com/Krishna-Rohra" target="_blank" title="View on GitHub">
      <i class="fab fa-github"></i>
    </a>
    <a href="#" title="Coming Soon">
      <i class="fab fa-instagram"></i>
    </a>
  </div>
</footer>

<script src="/main.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/appwrite@13.0.1"></script>
<script type="module">
  import { Client, Account, ID } from "https://cdn.jsdelivr.net/npm/appwrite@13.0.1/+esm";

  const client = new Client()
    .setEndpoint("https://fra.cloud.appwrite.io/v1")
    .setProject("68832888001231497d2f");
    

  const account = new Account(client);
  let currentUser = null;

  function showDashboard() {
    document.getElementById("auth-section").style.display = "none";
    document.getElementById("logout-btn").style.display = "block";
    document.querySelector("header").style.display = "flex";
    document.querySelector(".upload-section").style.display = "block";
    document.getElementById("gallery").style.display = "grid";
    document.getElementById("footer").style.display = "block";
    if (music.paused) music.play();

  }

  function hideDashboard() {
    document.getElementById("auth-section").style.display = "block";
    document.getElementById("logout-btn").style.display = "none";
    document.querySelector("header").style.display = "none";
    document.querySelector(".upload-section").style.display = "none";
    document.getElementById("gallery").style.display = "none";
    document.getElementById("footer").style.display = "none";
  }

  async function login(email, password) {
    try {
      await account.createEmailSession(email, password);
      currentUser = await account.get();
      showDashboard();
    } catch (err) {
      alert("Login failed");
    }
  }

  document.getElementById("signup").onclick = async () => {
    const name = document.getElementById("name").value;
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;

    try {
      await account.create(ID.unique(), email, password, name);
      await login(email, password);
    } catch (err) {
      alert("Signup failed: " + err.message);
    }
  };

  document.getElementById("login").onclick = async () => {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    await login(email, password);
  };

  document.getElementById("logout-btn").onclick = async () => {
    try {
      await account.deleteSession("current");
      location.reload();
    } catch (err) {
      alert("Logout failed");
    }
  };

  (async () => {
    try {
      currentUser = await account.get();
      showDashboard();
    } catch {
      hideDashboard();
    }
  })();

  // Toggle dropdown menu
  const menuToggle = document.getElementById("menu-toggle");
  const menuDropdown = document.getElementById("menu-dropdown");
  menuToggle.onclick = () => {
    menuDropdown.classList.toggle("hidden");
  };
</script>

</body>
</html>
